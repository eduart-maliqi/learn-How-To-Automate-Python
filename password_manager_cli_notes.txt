ğŸ§  Python Password Manager CLI Notes
ğŸ” Core Concepts & Modules (Updated with Encryption)

â†’ Building a secure command-line password manager with encryption, validation, and safe storage.

Key Modules Used:

random.choices(population, k=n) â†’ selects k random elements from population

string.ascii_letters + string.digits â†’ creates charset for passwords

open(file, mode, encoding="utf-8") â†’ file operations with proper encoding

input(prompt) â†’ user input from command line

cryptography.fernet.Fernet â†’ symmetric encryption/decryption

cryptography.hazmat.primitives.kdf.pbkdf2.PBKDF2HMAC â†’ key derivation function

base64.urlsafe_b64encode() â†’ encoding for encryption keys

os.urandom(16) â†’ generate cryptographically secure random bytes for salt

Key Concepts:

ğŸ”‘ Password Generation:
- Use random.choices() for cryptographically secure random selection
- Combine letters, digits, and safe special characters
- Configurable length with minimum validation (â‰¥ 1)
- Label validation (no colons, non-empty)

ğŸ” Encryption (NEW):
- Fernet symmetric encryption for all passwords
- Master password required to unlock vault
- PBKDF2HMAC key derivation with 390,000 iterations
- SHA-256 hashing algorithm
- Persistent salt stored in vault.salt file
- Automatic encryption on save, decryption on display

ğŸ’¾ File Storage:
- Encrypted storage in passwords.txt
- Salt stored separately in vault.salt
- UTF-8 encoding for proper character handling
- Upsert functionality (update or insert)
- Error handling for missing files
- Backwards compatible with plaintext entries

ğŸ¯ Program Flow:
- Init crypto with master password on startup
- Main loop with menu options
- Input validation and error handling
- Duplicate detection with confirmation
- Clean exit with break statement

ğŸ“ Code Structure:

def generate_password(length: int) -> str:
    chars = random.choices(CHARSET, k=length)
    return "".join(chars)

def init_crypto():
    # Master password input
    # Load or create salt
    # Derive encryption key with PBKDF2
    # Initialize Fernet cipher

def _salt():
    # Load existing salt or generate new 16-byte salt
    # Store in vault.salt file

def create_entry():
    # Input collection with validation
    # Password generation
    # Encrypt password with Fernet
    # Save encrypted token to file

def upsert_entry(label, encrypted_value):
    # Read existing entries
    # Replace if label exists
    # Append if new
    # Write back to file

def list_passwords():
    # File reading
    # Decrypt each password with Fernet
    # Display label: decrypted_password
    # Handle legacy plaintext gracefully

def main():
    while True:
        # Menu display
        # Choice handling
        # Function calls

ğŸ”’ Security Features (UPGRADED):

âœ… Fernet symmetric encryption (AES-128 in CBC mode)
âœ… PBKDF2 key derivation (390,000 iterations with SHA-256)
âœ… Master password protection
âœ… Persistent salt for key derivation
âœ… Encrypted storage (not plaintext!)
âœ… Safe character set (avoiding problematic symbols)
âœ… Local storage with encryption at rest
âœ… Backwards compatible with legacy plaintext

âš¡ Best Practices:

- Use with open() for automatic file closing
- Validate user input before processing (length â‰¥ 1, no ':' in labels)
- Provide clear user feedback
- Handle file not found gracefully
- Use type hints for better code quality
- Encrypt immediately after generation
- Decrypt only when displaying
- Store salt separately from encrypted data
- Use high iteration count (390,000) for PBKDF2

ğŸ” Encryption Workflow:

1. User enters master password
2. Load/create salt from vault.salt
3. Derive 32-byte key using PBKDF2HMAC
4. Initialize Fernet cipher with derived key
5. Generate random password
6. Encrypt with Fernet.encrypt() â†’ returns bytes
7. Decode to string and store in file
8. On display: decrypt with Fernet.decrypt()

ğŸ”‘ Quick Reference:

random + string â†’ Password generation
cryptography.fernet â†’ Symmetric encryption
PBKDF2HMAC â†’ Key derivation from master password
base64 â†’ Key encoding
os.urandom() â†’ Secure salt generation
open() + encoding â†’ File operations
while True + input() â†’ Interactive menu
try/except â†’ Error handling + backwards compatibility</content>
<parameter name="filePath">c:\Projects\Python\python.automate\learn-How-To-Automate-Python\password_manager_cli_notes.txt